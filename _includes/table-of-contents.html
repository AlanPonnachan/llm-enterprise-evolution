<div class="toc-title">Table of Contents</div>
<ul id="toc-list">
    <!-- TOC will be generated by JavaScript -->
</ul>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const tocList = document.getElementById('toc-list');
    const headings = document.querySelectorAll('.post-content h2, .post-content h3, .post-content h4');
    
    if (headings.length === 0) {
        document.querySelector('.table-of-contents').style.display = 'none';
        return;
    }
    
    headings.forEach((heading, index) => {
        // Create ID if it doesn't exist
        if (!heading.id) {
            heading.id = 'heading-' + index;
        }
        
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = '#' + heading.id;
        a.textContent = heading.textContent;
        a.className = 'toc-' + heading.tagName.toLowerCase();
        
        li.appendChild(a);
        tocList.appendChild(li);
    });
    
    // Highlight current section
    function highlightCurrentSection() {
        const scrollTop = window.pageYOffset;
        const tocLinks = document.querySelectorAll('#toc-list a');
        
        let current = '';
        headings.forEach(heading => {
            const rect = heading.getBoundingClientRect();
            if (rect.top <= 100) {
                current = heading.id;
            }
        });
        
        tocLinks.forEach(link => {
            link.classList.remove('active');
            if (link.getAttribute('href') === '#' + current) {
                link.classList.add('active');
            }
        });
    }
    
    window.addEventListener('scroll', highlightCurrentSection);
    highlightCurrentSection(); // Initial call
});
</script>

<style>
.toc-h3 {
    margin-left: 1rem;
    font-size: 0.85rem;
}

.toc-h4 {
    margin-left: 2rem;
    font-size: 0.8rem;
}
</style>